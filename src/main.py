import networkx as nx
import matplotlib.pyplot as plt
from math import *
import scipy.optimize as optimize
tsp = nx.approximation.traveling_salesman_problem
SA_tsp = nx.approximation.simulated_annealing_tsp
atsp = nx.approximation.asadpour_atsp

def path_finding(G):
    G.add_node("E")
    for node in G:
        G.add_edge("E",node,weight=999)
        G.add_edge(node,"E",weight=999)
    method = lambda G, wt: SA_tsp(G, "greedy",source="E",alpha=0.99,temp=2,N_inner=5,max_iterations=10)
    path = tsp(G,method=method)
    path.pop(0)
    path.pop(len(path)-1)
    return path

def cost(G,path):
    return sum(G[n][nbr]["weight"] for n, nbr in nx.utils.pairwise(path))


"""
#bestpath =
 ['Porte de Saint-Cloud', 'Marcel Sembat', 'Billancourt', 'Pont de Sèvres', 'Billancourt', 'Marcel Sembat', 'Porte de Saint-Cloud', 'Parc des Princes', 'Exelmans', 'Michel-Ange - Molitor', 'Chardon-Lagache', 'Mirabeau', 'Javel - André Citroën', "Église d'Auteuil", 'Michel-Ange - Auteuil', "Porte d'Auteuil", 'Boulogne - Jean Jaurès', 'Boulogne - Pont de Saint-Cloud', 'Boulogne - Jean Jaurès', 'Michel-Ange - Molitor', 'Michel-Ange - Auteuil', 'Jasmin', 'Ranelagh', 'La Muette', 'Rue de la Pompe', 'Trocadéro', 'Boissière', 'Kléber', 'Charles de Gaulle - Étoile', 'Ternes', 'Courcelles', 'Monceau', 'Villiers', 'Malesherbes', 'Wagram', 'Maréchal Juin', 'Pereire', 'Porte de Champerret', 'Louise Michel', 'Anatole France', 'Pont de Levallois - Bécon', 'Anatole France', 'Louise Michel', 'Porte de Champerret', 'Pereire', 'Maréchal Juin', 'Wagram', 'Malesherbes', 'Villiers', 'Europe', 'Simone Veil', 'Saint-Lazare', 'Liège', 'Place de Clichy', 'La Fourche', 'Guy Môquet', 'Porte de Saint-Ouen', 'Garibaldi', 'Mairie de Saint-Ouen', 'Carrefour Pleyel', 'Saint-Denis - Porte de Paris', 'Basilique de Saint-Denis', 'Saint-Denis - Université', 'Basilique de Saint-Denis', 'Saint-Denis - Porte de Paris', 'Carrefour Pleyel', 'Mairie de Saint-Ouen', 'Saint-Ouen', 'Porte de Clichy', 'Mairie de Clichy', 'Gabriel Péri', 'Les Agnettes', 'Asnières - Gennevilliers', 'Les Agnettes', 'Gabriel Péri', 'Mairie de Clichy', 'Porte de Clichy', 'Brochant', 'Porte de Clichy', 'Tribunal de Paris', 'Pont Cardinet', 'Saint-Lazare', 'Miromesnil', 'Champs-Élysées - Clemenceau', 'Invalides', 'Varenne', 'Saint-François-Xavier', 'Duroc', 'Montparnasse - Bienvenüe', 'Edgar Quinet', 'Raspail', 'Denfert-Rochereau', 'Colonel Rol-Tanguy', 'Saint-Jacques', 'Glacière', 'Corvisart', "Place d'Italie", 'Nationale', 'Chevaleret', 'Quai de la Gare', 'Bercy', 'Dugommier', 'Daumesnil', 'Bel-Air', 'Picpus', 'Nation', 'Avron', 'Alexandre Dumas', 'Philippe Auguste', 'Père Lachaise', 'Rue Saint-Maur', 'Parmentier', 'République', 'Arts et Métiers', 'Rambuteau', 'Hôtel de Ville', 'Châtelet', 'Pont-Neuf', 'Palais-Royal - Musée du Louvre', 'Pyramides', 'Opéra', "Chaussée d'Antin - La Fayette", 'Le Peletier', 'Cadet', 'Poissonnière', "Gare de l'Est", 'Château-Landon', 'Louis Blanc', 'Jaurès', 'Bolivar', 'Buttes Chaumont', 'Botzaris', 'Place des Fêtes', 'Pré-Saint-Gervais', 'Danube', 'Botzaris', 'Place des Fêtes', 'Jourdain', 'Pyrénées', 'Belleville', 'Hôpital Saint-Louis', 'Goncourt', 'République', 'Jacques Bonsergent', "Gare de l'Est", 'Gare du Nord', 'Stalingrad', 'Riquet', 'Crimée', 'Corentin Cariou', "Cité des Sciences et de l'Industrie", 'Porte de la Villette', 'Aubervilliers - Pantin - Quatre Chemins', "Fort d'Aubervilliers", 'La Courneuve - 8 Mai 1945', "Fort d'Aubervilliers", 'Aubervilliers - Pantin - Quatre Chemins', 'Porte de la Villette', "Cité des Sciences et de l'Industrie", 'Corentin Cariou', 'Crimée', 'Riquet', 'Stalingrad', 'La Chapelle', 'Barbès - Rochechouart', 'Château Rouge', 'Marcadet - Poissonniers', 'Marx Dormoy', 'Porte de la Chapelle', 'Front populaire', 'Aimé Césaire', "Mairie d'Aubervilliers", 'Aimé Césaire', 'Front populaire', 'Porte de la Chapelle', 'Marx Dormoy', 'Marcadet - Poissonniers', 'Jules Joffrin', 'Lamarck - Caulaincourt', 'Abbesses', 'Butte Montmartre', 'Pigalle', 'Saint-Georges', 'Notre-Dame-de-Lorette', "Trinité - d'Estienne d'Orves", 'Saint-Lazare', 'Havre - Caumartin', 'Saint-Augustin', 'Miromesnil', 'Saint-Philippe du Roule', 'Franklin D. Roosevelt', 'Alma - Marceau', 'Iéna', 'Trocadéro', 'Passy', 'Bir-Hakeim', 'Tour Eiffel', 'Dupleix', 'La Motte-Picquet - Grenelle', 'Cambronne', 'Sèvres - Lecourbe', 'Pasteur', 'Volontaires', 'Vaugirard', 'Convention', 'Porte de Versailles', 'Corentin Celton', "Mairie d'Issy", 'Corentin Celton', 'Porte de Versailles', 'Convention', 'Vaugirard', 'Volontaires', 'Pasteur', 'Falguière', 'Montparnasse - Bienvenüe', 'Gaîté', 'Pernety', 'Plaisance', 'Porte de Vanves', 'Malakoff - Plateau de Vanves', 'Malakoff - Rue Étienne-Dolet', 'Châtillon - Montrouge', 'Malakoff - Rue Étienne-Dolet', 'Malakoff - Plateau de Vanves', 'Porte de Vanves', 'Plaisance', 'Pernety', 'Gaîté', 'Montparnasse - Bienvenüe', 'Notre-Dame-des-Champs', 'Rennes', 'Sèvres - Babylone', 'Mabillon', 'Odéon', 'Cluny - La Sorbonne', 'Maubert - Mutualité', 'Cardinal Lemoine', 'Jussieu', 'Sully - Morland', 'Cité des Arts', 'Pont Marie', 'Châtelet', 'Les Halles', 'Étienne Marcel', 'Réaumur - Sébastopol', 'Sentier', 'Bourse', 'Quatre-Septembre', 'Opéra', 'Richelieu - Drouot', 'Grands Boulevards', 'Bonne-Nouvelle', 'Strasbourg - Saint-Denis', "Château d'Eau", 'Strasbourg - Saint-Denis', 'République', 'Temple', 'République', 'Filles du Calvaire', 'Saint-Sébastien - Froissart', 'Chemin Vert', 'Bastille', 'Quai de la Rapée', "Gare d'Austerlitz", 'Saint-Marcel', 'Campo-Formio', "Place d'Italie", 'Tolbiac', 'Maison Blanche', 'Le Kremlin-Bicêtre', 'Villejuif - Léo Lagrange', 'Villejuif - Paul Vaillant-Couturier', 'Hôpital Paul Brousse', 'Villejuif - Louis Aragon', 'Hôpital Paul Brousse', 'Villejuif - Paul Vaillant-Couturier', 'Villejuif - Léo Lagrange', 'Le Kremlin-Bicêtre', 'Maison Blanche', "Porte d'Italie", 'Porte de Choisy', "Porte d'Ivry", 'Pierre et Marie Curie', "Mairie d'Ivry", 'Pierre et Marie Curie', "Porte d'Ivry", 'Porte de Choisy', "Porte d'Italie", 'Maison Blanche', 'Tolbiac', "Place d'Italie", 'Les Gobelins', 'Censier - Daubenton', 'Jardin des Plantes - Arènes de Lutèce', 'Place Monge', 'Jussieu', "Gare d'Austerlitz", 'Quai de la Rapée', 'Bastille', 'Bréguet - Sabin', 'Richard-Lenoir', 'Oberkampf', 'Saint-Ambroise', 'Voltaire', 'Charonne', 'Rue des Boulets', 'Nation', 'Buzenval', 'Maraîchers', 'Porte de Montreuil', 'Robespierre', 'Croix de Chavaux', 'Mairie de Montreuil\xa0', 'Croix de Chavaux', 'Robespierre', 'Porte de Montreuil', 'Maraîchers', 'Buzenval', 'Nation', 'Porte de Vincennes', 'Saint-Mand?', 'B?rault', 'Ch?teau de Vincennes', 'B?rault', 'Saint-Mand?', 'Porte de Vincennes', 'Nation', 'Reuilly - Diderot', 'Faidherbe - Chaligny', 'Ledru-Rollin', 'Bastille', 'Le Marais', 'Saint-Paul', 'H?tel de Ville', 'Ch?telet', 'Louvre - Rivoli', 'Palais-Royal - Mus?e du Louvre', 'Tuileries', 'Concorde', 'Assemblée nationale', 'Solférino', 'Rue du Bac', 'Sèvres - Babylone', 'Vaneau', 'Duroc', 'Ségur', 'La Motte-Picquet - Grenelle', 'Avenue Émile-Zola', 'Charles Michels', 'Avenue Émile-Zola', 'La Motte-Picquet - Grenelle', 'École Militaire', 'La Tour-Maubourg', 'Invalides', 'Concorde', 'Madeleine', 'Concorde', 'Grand Palais', 'Champs-?lys?es - Clemenceau', 'Franklin D. Roosevelt', 'George V', 'Charles de Gaulle - ?toile', 'Argentine', 'Palais des Congr?s', 'Porte Maillot', "Jardin d'Acclimatation", 'Les Sablons', 'Pont de Neuilly', 'Esplanade de La D?fense', 'La D?fense', 'Esplanade de La D?fense', 'Pont de Neuilly', 'Les Sablons', "Jardin d'Acclimatation", 'Porte Maillot', 'Palais des Congr?s', 'Argentine', 'Charles de Gaulle - ?toile', 'George V', 'Franklin D. Roosevelt', 'Saint-Philippe du Roule', 'Miromesnil', 'Saint-Lazare', 'Liège', 'Place de Clichy', 'Rome', 'Place de Clichy', 'Blanche', 'Pigalle', 'Anvers', 'Sacré-Cœur', 'Barbès - Rochechouart', 'Château Rouge', 'Marcadet - Poissonniers', 'Simplon', 'Porte de Clignancourt', 'Simplon', 'Marcadet - Poissonniers', 'Château Rouge', 'Barbès - Rochechouart', 'Gare du Nord', 'Stalingrad', 'Jaurès', 'Laumière', 'Ourcq', 'Parc de la Villette', 'Porte de Pantin', 'Hoche', 'Église de Pantin', 'Bobigny - Pantin - Raymond Queneau', 'Bobigny - Pablo Picasso', 'Bobigny - Pantin - Raymond Queneau', 'Église de Pantin', 'Hoche', 'Porte de Pantin', 'Parc de la Villette', 'Ourcq', 'Laumière', 'Jaurès', 'Colonel Fabien', 'Belleville', 'Couronnes', 'Ménilmontant', 'Père Lachaise', 'Gambetta', 'Pelleport', 'Saint-Fargeau', 'Porte des Lilas', 'Télégraphe', 'Porte des Lilas', 'Mairie des Lilas', 'Porte des Lilas', 'Saint-Fargeau', 'Pelleport', 'Gambetta', 'Porte de Bagnolet', 'Gallieni', 'Porte de Bagnolet', 'Gambetta', 'Père Lachaise', 'Philippe Auguste', 'Alexandre Dumas', 'Avron', 'Nation', 'Reuilly - Diderot', 'Montgallet', 'Daumesnil', 'Michel Bizot', 'Porte Dorée', 'Porte de Charenton', 'Liberté', 'Charenton - Écoles', 'École vétérinaire de Maisons-Alfort', 'Maisons-Alfort - Stade', 'Maisons-Alfort - Les Juilliottes', "Créteil - L'Échat", 'Créteil - Université', 'Créteil - Préfecture', 'Créteil Pointe du Lac', 'Créteil - Préfecture', 'Créteil - Université', "Créteil - L'Échat", 'Maisons-Alfort - Les Juilliottes', 'Maisons-Alfort - Stade', 'École vétérinaire de Maisons-Alfort', 'Charenton - Écoles', 'Liberté', 'Porte de Charenton', 'Porte Dorée', 'Michel Bizot', 'Daumesnil', 'Dugommier', 'Bercy', 'Gare de Lyon', 'Châtelet', 'Cité', 'Saint-Michel', 'Odéon', 'Saint-Germain-des-Prés', 'Saint-Sulpice', 'Saint-Placide', 'Montparnasse - Bienvenüe', 'Vavin', 'Raspail', 'Denfert-Rochereau', 'Colonel Rol-Tanguy', 'Mouton-Duvernet', 'Alésia', "Porte d'Orléans\xa0Accessible", 'Mairie de Montrouge\xa0Accessible', 'Barbara\xa0Accessible', 'Bagneux - Lucie Aubrac\xa0Accessible', 'Barbara\xa0Accessible', 'Mairie de Montrouge\xa0Accessible', "Porte d'Orléans\xa0Accessible", 'Alésia', 'Mouton-Duvernet', 'Colonel Rol-Tanguy', 'Denfert-Rochereau', 'Raspail', 'Edgar Quinet', 'Montparnasse - Bienvenüe', 'Duroc', 'Ségur', 'La Motte-Picquet - Grenelle', 'Commerce', 'Félix Faure', 'Boucicaut', 'Lourmel', 'Balard', 'Lourmel', 'Boucicaut', 'Félix Faure', 'Commerce', 'La Motte-Picquet - Grenelle', 'Dupleix', 'Tour Eiffel', 'Bir-Hakeim', 'Passy', 'Trocadéro', 'Boissière', 'Kléber', 'Charles de Gaulle - Étoile', 'Victor Hugo', 'Porte Dauphine', 'Victor Hugo', 'Charles de Gaulle - Étoile', 'Ternes', 'Courcelles', 'Monceau', 'Villiers', 'Europe', 'Simone Veil', 'Saint-Lazare', 'Madeleine', 'Pyramides', 'Châtelet', 'Gare de Lyon', 'Bercy', 'Cour Saint-Émilion', 'Bibliothèque François-Mitterrand', 'Olympiades']
bestcost = 41153.08000000021
print_Graph(graph_RATP())

path = path_finding(RATP_Graph)
print(path)
print(int(cost))"""